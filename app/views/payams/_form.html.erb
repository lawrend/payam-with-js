<%# NEW PAYAM FORM %>

<section class="PostContent">
    <div class="flex-container-column text-boxer">

        <%= form_for(@payam, :html => {:class => "form-horizontal"}) do |f| %>

            <%# PAYAM ERROR MESSAGES %>
            <% if @payam.errors.any? %>
                <div id="error_explanation">
                    <h2><%= pluralize(@payam.errors.count, "error") %> stopped this Payam from going forward:</h2>
                    <ul>
                        <% @payam.errors.full_messages.each do |msg| %>
                            <li><%= msg %></li>
                        <% end %>
                    </ul>
                </div><!--error explanation-->
            <% end %>


            <% if @payam.counter == 1 %>
                <div class="container" style="border-bottom: 1px dotted; border-color: #dab4e4; padding-bottom: 20px">
                    <div class="flex-container">
                    <div class="container">
                        <p>Pick a style from a list...</p>
                        <div class="form-group col-sm-12">
                            <%= f.collection_select(:style_id, Style.all, :id, :name, {:include_blank => "Select a Style"}, :class => "form-control") %>
                        </div><!--form-group-->
                    </div><!--col-sm-6-->
                    <div class="container">
                        <p>Or make up a new style.</p>
                        <div class="form-group col-sm-12">
                            <%= f.fields_for :style, @style do |style_name| %>
                                <%= style_name.text_field :name, :placeholder => "Create a new one", :class => "form-control"%>
                            <% end %>
                        </div><!--form-group-->
                    </div><!--col-sm-6-->
                </div><!--flex-container-->
                <div class="container" style="text-align: center">
                    <%# <div class="col-sm-12"> %>
                        <p>Provide a one-word title to guide the later authors</p>
                        <div class="form-group col-sm-push-3 col-sm-6">
                            <%= f.text_field :title, :placeholder => "one-word title", class: "form-control" %><br>
                        </div>
                    <%# </div> %>
                </div>
            <% else %>
                <div class="container">
                    <h3>The style of this Payam is <span id="base-purp"><%= @payam.style.name%></span>, and the title is <span id="base-purp">"<%=@payam.title%>"</span>.</h3>
                </div>
            <%end%>

            <div class="container" style="border-top: 1px dotted; border-color: #dab4e4; padding-top: 20px">
                <% if @payam.counter == 1 %>
                    <p>Write the first line.
                <% else %>
                    <p>So far, the Payam has <%= @payam.counter - 1 %>
                <% if @payam.counter == 2 %>
                    author,
                <% else %>
                    authors,
                <% end %>
                and you are number <%= @payam.counter %>.</p>
                    <p>The previous author's last five words were:<em><blockquote id="base-purp" style="font-size: 20px">...<%= @payam.previous_five%></blockquote></em></p>
                    <p>Write the next line.
                <% end %>

                <% if @payam.counter == 8 %>
                    This is the last line, so make it count.<p><br>
                <% else %>
                    Make it between 10-20 words. The next writer will only see the last 5 words you write.</p><br>
                <% end %>

                <div class="container">
                    <div class="form-group">
                        <%= f.fields_for :lines, @line do |line| %>

                            <% if @payam.counter < 8 %>
                                <%= line.text_field :text, class: "form-control", placeholder: "Think about your last 5 words as they will be what the next author sees..." %><br>
                            <% else %>
                                <%= line.text_field :text, class: "form-control", placeholder: "These are the last words of the Payam..." %><br>
                            <% end %>
                            <!-- where the hidden fields were -->
                        <% end %>

                    </div><!--form-group-->
                </div><!--container-->
            </div><!--container with border-bottom-->
            <%= f.hidden_field :current_scribe, :value => current_user.id %>
            <div class="container">
                <div class="form-group">
                    <div class="col-sm-push-5 col-sm-1">
                        <%= f.submit "Submit", class: "btn btn-default" %>
                    </div>
                </div> <!-- form-group-->
            </div><!--container-->
        <% end %><!--end of form_for-->
    </div>
</section>
